<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MoodSpace - Emotional Wellness & Music</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* EXISTING STYLES - UNCHANGED */
        :root {
            /* Vibrant Sunshine Color Palette */
            --sunshine-yellow: #FFD700;
            --sunshine-orange: #FF8C00;
            --sky-blue: #87CEEB;
            --grass-green: #7CFC00;
            --flower-pink: #FF69B4;
            --lavender-purple: #9370DB;
            --coral: #FF7F50;
            --turquoise: #40E0D0;
            --white: #FFFFFF;
            --light-gray: #F5F5F5;
            --text-dark: #2C3E50;
            --text-light: #5D6D7E;

            --shadow: 0 8px 25px rgba(255, 215, 0, 0.2);
            --border-radius: 24px;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);

            /* Responsive font sizes */
            font-size: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Neue', 'Segoe UI', 'Nunito', sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        body {
            background: radial-gradient(circle at 50% 0%,
            var(--sunshine-yellow) 0%,
            #FFEC8B 30%,
            var(--sky-blue) 100%);
            color: var(--text-dark);
            line-height: 1.7;
            min-height: 100vh;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }

        /* Prevent text size adjustment on orientation change */
        @media screen and (max-device-width: 480px) {
            body {
                -webkit-text-size-adjust: 100%;
                text-size-adjust: 100%;
            }
        }

        /* Animated floating shapes */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                    radial-gradient(circle at 15% 10%, rgba(255, 215, 0, 0.15) 0%, transparent 25%),
                    radial-gradient(circle at 85% 30%, rgba(255, 140, 0, 0.15) 0%, transparent 25%),
                    radial-gradient(circle at 25% 70%, rgba(255, 105, 180, 0.15) 0%, transparent 25%),
                    radial-gradient(circle at 75% 90%, rgba(135, 206, 235, 0.15) 0%, transparent 25%);
            z-index: -1;
            animation: floatBackground 20s infinite alternate ease-in-out;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: 20px;
        }

        /* Page transitions */
        .page {
            display: none;
            animation: bounceIn 0.6s ease;
            width: 100%;
        }

        .page.active {
            display: block;
        }

        /* Header with Back Button - Sunshine Theme */
        header {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            padding: 20px 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow), 0 0 40px rgba(255, 215, 0, 0.3);
            text-align: center;
            border-left: 10px solid var(--sunshine-yellow);
            border-right: 10px solid var(--sunshine-orange);
            margin-bottom: 20px;
            position: relative;
            border-top: 4px solid var(--flower-pink);
            border-bottom: 4px solid var(--turquoise);
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .back-btn-top {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--sunshine-yellow), var(--sunshine-orange));
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 15px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.4);
            white-space: nowrap;
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
        }

        .back-btn-top:hover {
            background: linear-gradient(135deg, var(--sunshine-orange), var(--coral));
            transform: translateY(-50%) scale(1.1) rotate(-2deg);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.4);
        }

        /* Ensure header text doesn't overlap with back button on mobile */
        header h1 {
            padding-left: 0;
            padding-right: 0;
            margin-bottom: 15px;
            font-size: 1.8rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        header .subtitle {
            padding-left: 0;
            padding-right: 0;
            font-size: 1rem;
            margin: 10px 0;
        }

        h1 {
            color: var(--text-dark);
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 900;
            background: linear-gradient(135deg,
            var(--sunshine-orange),
            var(--flower-pink),
            var(--lavender-purple),
            var(--turquoise));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
            animation: colorShift 8s infinite alternate;
            line-height: 1.2;
        }

        h1 i {
            background: var(--sunshine-yellow);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--text-dark);
            font-size: 1rem;
            max-width: 100%;
            margin: 0 auto 15px;
            line-height: 1.4;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.8);
            padding: 12px 15px;
            border-radius: 15px;
            border: 2px dotted var(--sunshine-yellow);
        }

        .tagline {
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.9),
            rgba(255, 140, 0, 0.9));
            padding: 12px 18px;
            border-radius: 15px;
            font-size: 0.9rem;
            color: white;
            font-weight: 800;
            display: inline-block;
            border: 2px solid white;
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
            transform: rotate(-1deg);
            animation: bounce 2s infinite;
            margin-top: 10px;
        }

        /* Big Mood Buttons - Rainbow Theme */
        .mood-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
            width: 100%;
        }

        .big-mood-btn {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 255, 255, 0.8) 100%);
            border: none;
            border-radius: 20px;
            padding: 25px 15px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 3px solid transparent;
            touch-action: manipulation;
            min-height: 120px;
            width: 100%;
        }

        /* Mobile touch-friendly button sizes */
        @media (max-width: 768px) {
            .big-mood-btn {
                padding: 20px 10px;
                min-height: 100px;
            }
        }

        .big-mood-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
            transparent,
            rgba(255, 255, 255, 0.6),
            transparent);
            transition: 0.8s;
        }

        .big-mood-btn:hover::before {
            left: 100%;
        }

        .big-mood-btn:hover {
            transform: translateY(-8px) scale(1.05) rotate(2deg);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            border: 3px solid var(--sunshine-yellow);
        }

        /* Touch feedback for mobile */
        .big-mood-btn:active {
            transform: translateY(-2px) scale(0.98);
            transition: transform 0.1s ease;
        }

        .big-mood-btn i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            transition: var(--transition);
            background: linear-gradient(135deg,
            var(--sunshine-yellow),
            var(--sunshine-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .big-mood-btn:hover i {
            transform: scale(1.2) rotate(15deg);
            animation: wiggle 0.5s ease;
        }

        .big-mood-btn span {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--text-dark);
            transition: var(--transition);
            word-wrap: break-word;
            overflow-wrap: break-word;
            padding: 0 5px;
        }

        .big-mood-btn:hover span {
            color: var(--sunshine-orange);
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Emotion Grid - Page 2 */
        .emotion-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
            width: 100%;
        }

        .emotion-option {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            border: none;
            border-radius: 18px;
            padding: 20px 15px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 15px rgba(255, 140, 0, 0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-left: 8px solid var(--sunshine-yellow);
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
            backdrop-filter: blur(10px);
            touch-action: manipulation;
            min-height: 140px;
            width: 100%;
        }

        .emotion-option:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 12px 25px rgba(255, 140, 0, 0.25);
            border-top-color: var(--flower-pink);
            border-bottom-color: var(--turquoise);
            animation: happyWiggle 0.5s ease;
        }

        /* Touch feedback for mobile */
        .emotion-option:active {
            transform: translateY(-2px) scale(0.98);
            transition: transform 0.1s ease;
        }

        .emotion-option.selected {
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.2) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3),
            0 10px 20px rgba(255, 215, 0, 0.2);
            transform: scale(1.03);
            border-left-color: var(--coral);
        }

        .emotion-emoji {
            font-size: 2.5rem;
            margin-bottom: 15px;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
            animation: floatEmoji 3s infinite ease-in-out;
        }

        .emotion-name {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 8px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            padding: 0 5px;
        }

        .emotion-subtitle {
            font-size: 0.9rem;
            color: var(--text-light);
            line-height: 1.3;
            background: rgba(255, 255, 255, 0.7);
            padding: 6px 10px;
            border-radius: 12px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Coping Strategies - Sunshine Cards */
        .coping-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin: 30px 0;
            width: 100%;
        }

        .coping-card {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            padding: 25px 20px;
            border-radius: 20px;
            transition: var(--transition);
            box-shadow: 0 10px 20px rgba(255, 140, 0, 0.15);
            border-top: 8px solid var(--sunshine-yellow);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .coping-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg,
            var(--sunshine-yellow),
            var(--flower-pink),
            var(--turquoise),
            var(--lavender-purple));
            animation: rainbowLine 3s infinite linear;
        }

        .coping-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 30px rgba(255, 140, 0, 0.25);
        }

        .coping-card h3 {
            color: var(--sunshine-orange);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .coping-card h3 i {
            background: linear-gradient(135deg, var(--flower-pink), var(--lavender-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.5rem;
        }

        .coping-card p {
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-dark);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Music Player - Rainbow Theme */
        .music-player {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            padding: 25px 20px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 12px 25px rgba(255, 140, 0, 0.2);
            border: 3px solid var(--sunshine-yellow);
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .song-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
            width: 100%;
        }

        .song-item {
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.1) 0%,
            rgba(255, 248, 220, 0.9) 100%);
            border-radius: 15px;
            transition: var(--transition);
            border-left: 6px solid var(--lavender-purple);
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
            width: 100%;
        }

        .song-item:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 0 15px 30px rgba(147, 112, 219, 0.25);
            border-color: var(--flower-pink);
        }

        .song-item.active {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 240, 245, 0.95) 100%);
            border-left-color: var(--flower-pink);
            box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.3);
        }

        .song-info {
            padding: 20px;
            cursor: pointer;
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
        }

        .song-title {
            font-size: 1.2rem;
            font-weight: 800;
            margin-bottom: 8px;
            color: var(--sunshine-orange);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .song-artist {
            font-size: 1rem;
            color: var(--lavender-purple);
            margin-bottom: 8px;
            font-weight: 600;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .song-help {
            font-size: 0.9rem;
            color: var(--turquoise);
            font-style: italic;
            margin-bottom: 15px;
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .spotify-player {
            width: 100%;
            height: 152px;
            border: none;
            border-top: 2px solid rgba(255, 215, 0, 0.3);
            display: block;
        }

        .song-item.active .spotify-player {
            display: block;
        }

        .auto-play-notice {
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.2),
            rgba(147, 112, 219, 0.15));
            padding: 15px;
            border-radius: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: var(--lavender-purple);
            border-left: 4px solid var(--flower-pink);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 700;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .auto-play-notice i {
            font-size: 1.2rem;
            background: linear-gradient(135deg, var(--flower-pink), var(--lavender-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: spin 4s infinite linear;
            flex-shrink: 0;
        }

        /* Games Section - Playful Theme */
        .games-section {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            padding: 25px 20px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 15px 30px rgba(255, 140, 0, 0.2);
            border: 3px dotted var(--sunshine-yellow);
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .games-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            width: 100%;
        }

        .game-card {
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.15) 0%,
            rgba(255, 248, 220, 0.9) 100%);
            padding: 25px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 10px 20px rgba(255, 140, 0, 0.15);
            text-align: center;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
            min-height: 150px;
            width: 100%;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg,
            var(--sunshine-yellow),
            var(--flower-pink),
            var(--turquoise));
            animation: rainbowLine 2s infinite linear;
        }

        .game-card:hover {
            transform: translateY(-8px) scale(1.03) rotate(2deg);
            box-shadow: 0 20px 40px rgba(255, 140, 0, 0.3);
            border-color: var(--sunshine-yellow);
        }

        /* Touch feedback for mobile */
        .game-card:active {
            transform: translateY(-2px) scale(0.98);
            transition: transform 0.1s ease;
        }

        .game-card i {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--sunshine-yellow), var(--coral));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            transition: var(--transition);
        }

        .game-card:hover i {
            transform: scale(1.2) rotate(10deg);
            animation: bounceIcon 0.8s ease;
        }

        .game-card h3 {
            font-size: 1.3rem;
            color: var(--sunshine-orange);
            margin-bottom: 15px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .game-card p {
            font-size: 1rem;
            line-height: 1.4;
            color: var(--text-light);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Save Button - Sunshine Button */
        .save-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 3px dashed var(--sunshine-yellow);
            width: 100%;
        }

        .save-btn {
            background: linear-gradient(135deg,
            var(--sunshine-yellow),
            var(--sunshine-orange),
            var(--flower-pink));
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 40px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 800;
            box-shadow: 0 8px 20px rgba(255, 140, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            border: 3px solid white;
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
            width: auto;
            max-width: 100%;
        }

        .save-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
            transparent,
            rgba(255, 255, 255, 0.4),
            transparent);
            transition: 0.6s;
        }

        .save-btn:hover::before {
            left: 100%;
        }

        .save-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 30px rgba(255, 105, 180, 0.5);
            background: linear-gradient(135deg,
            var(--flower-pink),
            var(--sunshine-orange),
            var(--sunshine-yellow));
            animation: happyDance 0.5s ease;
        }

        /* Touch feedback for mobile */
        .save-btn:active {
            transform: translateY(-2px) scale(0.98);
            transition: transform 0.1s ease;
        }

        /* Footer - Rainbow Footer */
        footer {
            margin-top: 40px;
            text-align: center;
            color: var(--text-light);
            font-size: 1rem;
            padding: 25px 20px;
            width: 100%;
            max-width: 1200px;
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            border-radius: 20px;
            box-shadow: 0 12px 25px rgba(255, 215, 0, 0.2);
            border-top: 6px solid var(--sunshine-yellow);
            border-bottom: 6px solid var(--turquoise);
            backdrop-filter: blur(10px);
        }

        .emergency-contact {
            background: linear-gradient(135deg,
            rgba(255, 105, 180, 0.15) 0%,
            rgba(135, 206, 235, 0.15) 100%);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            font-weight: 700;
            color: var(--sunshine-orange);
            font-size: 1rem;
            border: 3px solid var(--sunshine-yellow);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.2);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Game Popups - Bright Game Windows */
        .game-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center,
            rgba(255, 215, 0, 0.95) 0%,
            rgba(255, 140, 0, 0.9) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
            padding: 10px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .game-popup.active {
            display: flex;
            animation: popIn 0.5s ease;
        }

        .game-content {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.98) 0%,
            rgba(255, 248, 220, 0.98) 100%);
            padding: 25px 20px;
            border-radius: 25px;
            max-width: 95%;
            width: 100%;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
            border: 6px solid var(--sunshine-yellow);
            position: relative;
            backdrop-filter: blur(20px);
            -webkit-overflow-scrolling: touch;
        }

        .close-game {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, var(--flower-pink), var(--lavender-purple));
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            z-index: 1001;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
        }

        .close-game:hover {
            transform: scale(1.2) rotate(90deg);
            background: linear-gradient(135deg, var(--coral), var(--flower-pink));
        }

        /* Number Find Game - Sunshine Game */
        .number-game-container {
            background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 248, 220, 0.95) 100%);
            width: 100%;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(255, 140, 0, 0.2);
            margin: 0 auto;
            border: 4px solid var(--sunshine-yellow);
        }

        .number-game-header {
            margin-bottom: 15px;
        }

        .number-game-header h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--sunshine-orange);
            background: linear-gradient(135deg, var(--sunshine-yellow), var(--coral));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .number-game-header p {
            margin: 8px 0 0;
            font-size: 1rem;
            color: var(--lavender-purple);
            font-weight: 600;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .number-game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.15),
            rgba(255, 248, 220, 0.8));
            border-radius: 15px;
            font-weight: 700;
            font-size: 1rem;
            border: 2px solid var(--sunshine-yellow);
            flex-wrap: wrap;
            gap: 10px;
        }

        .number-game-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .number-game-tile {
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg,
            rgba(255, 215, 0, 0.2),
            rgba(255, 248, 220, 0.9));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: var(--sunshine-orange);
            border: 2px solid var(--sunshine-yellow);
            box-shadow: 0 4px 10px rgba(255, 215, 0, 0.2);
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
        }

        .number-game-tile:hover {
            background: linear-gradient(135deg, var(--sunshine-yellow), var(--sunshine-orange));
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 15px rgba(255, 140, 0, 0.3);
            color: white;
            border-color: white;
        }

        /* Touch feedback for mobile */
        .number-game-tile:active {
            transform: translateY(-1px) scale(0.98);
            transition: transform 0.1s ease;
        }

        .number-game-tile.correct {
            background: linear-gradient(135deg, var(--grass-green), #32CD32);
            color: white;
            cursor: default;
            transform: scale(0.95);
            border-color: #228B22;
            animation: happyPop 0.3s ease;
        }

        .number-game-tile.disabled {
            pointer-events: none;
        }

        .number-game-footer {
            margin-top: 15px;
            text-align: center;
            width: 100%;
        }

        .number-game-finish {
            font-weight: 800;
            color: var(--grass-green);
            margin-bottom: 15px;
            font-size: 1.1rem;
            animation: celebrateText 1s infinite;
            word-wrap: break-word;
            overflow-wrap: break-word;
            padding: 0 10px;
        }

        /* Color Match Game - Rainbow Colors */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .color-btn {
            height: 70px;
            border-radius: 15px;
            border: 4px solid white;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
        }

        .color-btn:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        /* Touch feedback for mobile */
        .color-btn:active {
            transform: scale(1.05) rotate(2deg);
            transition: transform 0.1s ease;
        }

        .color-btn.active {
            border: 4px solid var(--sunshine-orange);
            box-shadow: 0 0 0 6px var(--sunshine-yellow);
            animation: pulseColor 1s infinite;
        }

        #targetColor {
            width: 100px;
            height: 100px;
            margin: 20px auto;
            border-radius: 20px;
            border: 6px solid white;
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
            animation: rainbowBorder 3s infinite linear;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            flex: 1;
            min-width: 100px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--sunshine-orange);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--lavender-purple);
            font-weight: 600;
        }

        /* Larger screens adjustments */
        @media (min-width: 768px) {
            :root {
                font-size: 18px;
            }

            .container {
                gap: 30px;
                padding-bottom: 30px;
            }

            header {
                padding: 25px 30px;
            }

            .back-btn-top {
                left: 20px;
                padding: 12px 20px;
                font-size: 1rem;
            }

            header h1 {
                font-size: 2.5rem;
                margin-bottom: 20px;
            }

            .subtitle {
                font-size: 1.3rem;
                padding: 15px 25px;
            }

            .tagline {
                font-size: 1.2rem;
                padding: 15px 25px;
            }

            .mood-buttons {
                grid-template-columns: repeat(3, 1fr);
                gap: 25px;
                margin: 30px 0;
            }

            .big-mood-btn {
                padding: 35px 20px;
                min-height: 150px;
                border-radius: 25px;
            }

            .big-mood-btn i {
                font-size: 3.5rem;
            }

            .big-mood-btn span {
                font-size: 1.5rem;
            }

            .emotion-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }

            .emotion-option {
                padding: 25px 20px;
                min-height: 180px;
                border-radius: 20px;
            }

            .emotion-emoji {
                font-size: 3.5rem;
            }

            .emotion-name {
                font-size: 1.3rem;
            }

            .emotion-subtitle {
                font-size: 1.1rem;
            }

            .coping-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 25px;
            }

            .coping-card {
                padding: 30px 25px;
                border-radius: 25px;
            }

            .coping-card h3 {
                font-size: 1.5rem;
            }

            .coping-card p {
                font-size: 1.2rem;
            }

            .music-player {
                padding: 30px 25px;
                border-radius: 25px;
            }

            .song-list {
                grid-template-columns: repeat(2, 1fr);
                gap: 25px;
            }

            .song-title {
                font-size: 1.4rem;
            }

            .song-artist {
                font-size: 1.2rem;
            }

            .song-help {
                font-size: 1.1rem;
            }

            .games-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 25px;
            }

            .game-card {
                padding: 30px 25px;
                border-radius: 25px;
                min-height: 200px;
            }

            .game-card i {
                font-size: 3.5rem;
            }

            .game-card h3 {
                font-size: 1.6rem;
            }

            .game-card p {
                font-size: 1.2rem;
            }

            .save-btn {
                padding: 20px 40px;
                font-size: 1.3rem;
                border-radius: 50px;
            }

            footer {
                padding: 30px;
                border-radius: 25px;
                font-size: 1.2rem;
            }

            .emergency-contact {
                padding: 25px;
                font-size: 1.2rem;
            }

            .game-content {
                padding: 35px 30px;
                border-radius: 30px;
                max-width: 800px;
            }

            .close-game {
                top: 25px;
                right: 25px;
                width: 50px;
                height: 50px;
                font-size: 2.5rem;
            }

            .number-game-container {
                padding: 30px;
                border-radius: 25px;
                max-width: 500px;
            }

            .number-game-header h2 {
                font-size: 2rem;
            }

            .number-game-header p {
                font-size: 1.2rem;
            }

            .number-game-stats {
                padding: 20px;
                font-size: 1.2rem;
            }

            .number-game-grid {
                gap: 12px;
            }

            .number-game-tile {
                height: 60px;
                font-size: 1.3rem;
            }

            .number-game-finish {
                font-size: 1.3rem;
            }

            .color-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 20px;
            }

            .color-btn {
                height: 90px;
            }

            #targetColor {
                width: 120px;
                height: 120px;
            }

            .stat-value {
                font-size: 2rem;
            }

            .stat-label {
                font-size: 1.1rem;
            }
        }

        @media (min-width: 992px) {
            .mood-buttons {
                grid-template-columns: repeat(4, 1fr);
            }

            .emotion-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .coping-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .song-list {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 480px) {
            .mood-buttons {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .emotion-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .big-mood-btn {
                min-height: 90px;
                padding: 15px 10px;
            }

            .big-mood-btn i {
                font-size: 2rem;
            }

            .big-mood-btn span {
                font-size: 1rem;
            }

            .emotion-option {
                min-height: 120px;
                padding: 15px 10px;
            }

            .emotion-emoji {
                font-size: 2rem;
            }

            .emotion-name {
                font-size: 1rem;
            }

            .emotion-subtitle {
                font-size: 0.8rem;
            }

            .number-game-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .number-game-tile {
                height: 40px;
                font-size: 1rem;
                min-height: 40px;
                min-width: 40px;
            }

            .color-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }

            .color-btn {
                height: 60px;
                min-height: 44px;
                min-width: 44px;
            }

            #targetColor {
                width: 80px;
                height: 80px;
            }

            .game-stats {
                gap: 10px;
            }

            .stat-item {
                min-width: 80px;
            }

            .stat-value {
                font-size: 1.3rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }
        }

        @media (orientation: landscape) and (max-height: 500px) {
            .container {
                gap: 10px;
            }

            header {
                padding: 15px 10px;
                margin-bottom: 10px;
            }

            header h1 {
                font-size: 1.5rem;
                margin-bottom: 10px;
            }

            .subtitle {
                font-size: 0.9rem;
                padding: 8px 10px;
                margin-bottom: 10px;
            }

            .tagline {
                font-size: 0.8rem;
                padding: 8px 12px;
            }

            .mood-buttons {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
                margin: 15px 0;
            }

            .big-mood-btn {
                padding: 10px 5px;
                min-height: 80px;
            }

            .big-mood-btn i {
                font-size: 1.5rem;
                margin-bottom: 8px;
            }

            .big-mood-btn span {
                font-size: 0.9rem;
            }
        }

        /* Animations */
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3) rotate(-15deg); }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { opacity: 1; transform: scale(1) rotate(0); }
        }

        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.5) translateY(50px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        @keyframes floatBackground {
            0% { transform: translateY(0px) rotate(0deg); }
            100% { transform: translateY(20px) rotate(1deg); }
        }

        @keyframes colorShift {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) rotate(-1deg); }
            50% { transform: translateY(-10px) rotate(1deg); }
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        @keyframes happyWiggle {
            0%, 100% { transform: translateY(0) rotate(0); }
            25% { transform: translateY(-5px) rotate(-2deg); }
            75% { transform: translateY(-5px) rotate(2deg); }
        }

        @keyframes floatEmoji {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
        }

        @keyframes rainbowLine {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes bounceIcon {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes happyDance {
            0%, 100% { transform: translateY(0) rotate(0); }
            25% { transform: translateY(-5px) rotate(-5deg); }
            50% { transform: translateY(-10px) rotate(0); }
            75% { transform: translateY(-5px) rotate(5deg); }
        }

        @keyframes happyPop {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.1); }
            100% { transform: scale(0.95); }
        }

        @keyframes celebrateText {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes pulseColor {
            0% { box-shadow: 0 0 0 0 rgba(255, 140, 0, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 140, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 140, 0, 0); }
        }

        @keyframes rainbowBorder {
            0% { border-color: var(--sunshine-yellow); }
            25% { border-color: var(--flower-pink); }
            50% { border-color: var(--turquoise); }
            75% { border-color: var(--lavender-purple); }
            100% { border-color: var(--sunshine-yellow); }
        }

        /* Emotion-specific colors */
        .happy-color {
            border-bottom-color: var(--sunshine-yellow);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 248, 220, 0.9));
        }
        .sad-color {
            border-bottom-color: var(--sky-blue);
            background: linear-gradient(135deg, rgba(135, 206, 235, 0.1), rgba(255, 248, 220, 0.9));
        }
        .angry-color {
            border-bottom-color: var(--coral);
            background: linear-gradient(135deg, rgba(255, 127, 80, 0.1), rgba(255, 248, 220, 0.9));
        }
        .anxious-color {
            border-bottom-color: var(--lavender-purple);
            background: linear-gradient(135deg, rgba(147, 112, 219, 0.1), rgba(255, 248, 220, 0.9));
        }
        .overwhelmed-color {
            border-bottom-color: var(--sunshine-orange);
            background: linear-gradient(135deg, rgba(255, 140, 0, 0.1), rgba(255, 248, 220, 0.9));
        }
        .lonely-color {
            border-bottom-color: var(--turquoise);
            background: linear-gradient(135deg, rgba(64, 224, 208, 0.1), rgba(255, 248, 220, 0.9));
        }
        .tired-color {
            border-bottom-color: var(--grass-green);
            background: linear-gradient(135deg, rgba(124, 252, 0, 0.1), rgba(255, 248, 220, 0.9));
        }
        .calm-color {
            border-bottom-color: var(--sky-blue);
            background: linear-gradient(135deg, rgba(135, 206, 235, 0.1), rgba(255, 248, 220, 0.9));
        }
        .unknown-color {
            border-bottom-color: var(--flower-pink);
            background: linear-gradient(135deg, rgba(255, 105, 180, 0.1), rgba(255, 248, 220, 0.9));
        }

        /* Game-specific colors for color game */
        .game-color-1 { background-color: var(--sunshine-yellow); }
        .game-color-2 { background-color: var(--flower-pink); }
        .game-color-3 { background-color: var(--turquoise); }
        .game-color-4 { background-color: var(--grass-green); }
        .game-color-5 { background-color: var(--lavender-purple); }
        .game-color-6 { background-color: var(--sky-blue); }
        .game-color-7 { background-color: var(--coral); }
        .game-color-8 { background-color: var(--sunshine-orange); }

        /* iOS specific fixes */
        @supports (-webkit-touch-callout: none) {
            .container {
                padding-bottom: env(safe-area-inset-bottom, 20px);
            }

            body {
                padding-top: env(safe-area-inset-top, 10px);
                padding-bottom: env(safe-area-inset-bottom, 10px);
            }

            .save-btn, .back-btn-top, .close-game, .big-mood-btn, .emotion-option, .game-card, .song-info, .number-game-tile, .color-btn {
                cursor: pointer;
            }
        }

        /* Prevent zoom on input focus for mobile */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
</head>
<body>

<!-- EXISTING APP CONTENT - UNCHANGED -->
<div class="container" id="appContainer">
    <!-- Page 1: Quick Emotion Selection -->
    <section class="page active" id="page1">
        <header>
            <h1><i class="fas fa-heart"></i> MoodSpace</h1>
            <p class="subtitle">Your happy place for emotional wellbeing! Tap how you're feeling and let's spread some happiness together! üåà</p>
            <div class="tagline">"Every feeling deserves a little sunshine!" ‚òÄÔ∏è</div>
        </header>

        <div class="mood-buttons">
            <button class="big-mood-btn happy-color" data-emotion="happy">
                <i class="fas fa-smile-beam"></i>
                <span>Happy üòä</span>
            </button>

            <button class="big-mood-btn sad-color" data-emotion="sad">
                <i class="fas fa-sad-tear"></i>
                <span>Sad üåßÔ∏è</span>
            </button>

            <button class="big-mood-btn angry-color" data-emotion="angry">
                <i class="fas fa-angry"></i>
                <span>Angry/Irritated üî•</span>
            </button>

            <button class="big-mood-btn anxious-color" data-emotion="anxious">
                <i class="fas fa-surprise"></i>
                <span>Fearful/Anxious ü¶ã</span>
            </button>

            <button class="big-mood-btn overwhelmed-color" data-emotion="overwhelmed">
                <i class="fas fa-cloud-rain"></i>
                <span>Overwhelmed üå™Ô∏è</span>
            </button>

            <button class="big-mood-btn lonely-color" data-emotion="lonely">
                <i class="fas fa-user-alone"></i>
                <span>Lonely üåô</span>
            </button>

            <button class="big-mood-btn tired-color" data-emotion="tired">
                <i class="fas fa-tired"></i>
                <span>Tired/Burnt Out üí§</span>
            </button>

            <button class="big-mood-btn calm-color" data-emotion="calm">
                <i class="fas fa-peace"></i>
                <span>Calm/Peaceful üåø</span>
            </button>

            <!-- NEW: "I don't know" emotion button -->
            <button class="big-mood-btn unknown-color" data-emotion="unknown">
                <i class="fas fa-question-circle"></i>
                <span>I'm Not Sure ü§î</span>
            </button>
        </div>

        <footer>
            <p>Welcome to your mood space! Even cloudy feelings look brighter here! ‚òÅÔ∏è‚û°Ô∏è‚òÄÔ∏è</p>
            <div class="emergency-contact (counselors number)">
            </div>
        </footer>
    </section>

    <!-- Page 2: Specific Emotion & Coping -->
    <section class="page" id="page2">
        <header>
            <button class="back-btn-top" id="backToPage1">
                <i class="fas fa-arrow-left"></i> Back to MoodSpace
            </button>
            <h1><i class="fas fa-search-heart"></i> Let's Find Your Happiness! üåà</h1>
            <p class="subtitle">Feeling uncertain is like a rainbow before the sunshine! Let's explore together! ‚ú®</p>
            <div class="tagline" id="selectedEmotionTag">Exploring: <span id="selectedEmotionText">I'm Not Sure</span></div>
        </header>

        <div id="emotionGridContainer">
            <!-- Emotions will be loaded here based on selection -->
        </div>

        <div id="copingSection" style="display: none;">
            <h2 style="margin: 40px 0 20px; font-size: 1.8rem;">
                <i class="fas fa-life-ring"></i> Coping Strategies ‚òÄÔ∏è
            </h2>
            <div id="copingGrid" class="coping-grid">
                <!-- Coping strategies will be loaded here -->
            </div>

            <div id="musicPlayer" class="music-player">
                <h2 style="margin-bottom: 20px; font-size: 1.8rem;">
                    <i class="fab fa-spotify"></i> Musical Sunshine! üéµ
                </h2>
                <p style="font-size: 1.1rem; margin-bottom: 20px;">Click any song to fill your space with happy vibes! üé∂‚ú®</p>

                <div id="songList" class="song-list">
                    <!-- Songs will be loaded here -->
                </div>

                <div class="auto-play-notice">
                    <i class="fas fa-volume-up"></i>
                    <span>Music is happiness for your soul! Let's dance! üíÉüï∫</span>
                </div>
            </div>

            <div class="games-section">
                <div class="games-header">
                    <h2 style="margin-bottom: 15px; font-size: 1.8rem;">
                        <i class="fas fa-gamepad"></i> Fun Breaks! üéÆ
                    </h2>
                    <p style="font-size: 1.1rem;">Take a happy break with these fun games! üåû‚ú®</p>
                </div>

                <div class="games-grid">
                    <div class="game-card" id="numberFindGame">
                        <i class="fas fa-search"></i>
                        <h3>Find Numbers Fun! üî¢</h3>
                        <p>Find numbers 1-25 in order! How fast can you go? ‚ö°</p>
                    </div>

                    <div class="game-card" id="colorMatchGame">
                        <i class="fas fa-palette"></i>
                        <h3>Rainbow Match! üåà</h3>
                        <p>Match the colors in this happy rainbow game! üé®</p>
                    </div>
                </div>
            </div>

            <div class="save-section">
                <button class="save-btn" id="saveEntryBtn">
                    <i class="fas fa-save"></i> Save & Spread Happiness! üåü
                </button>
            </div>
        </div>

        <footer>
            <p>Remember: Even rainbows need clouds first! Your feelings are creating something beautiful! üåà‚ú®</p>
        </footer>
    </section>
</div>

<!-- Game Popups -->
<div class="game-popup" id="numberFindPopup">
    <div class="game-content">
        <div class="number-game-container">
            <div class="number-game-header">
                <h2>Find Numbers Fun! üî¢‚ú®</h2>
                <p>Find numbers 1-25 in order! Let's race against time! ‚è±Ô∏è‚ö°</p>
            </div>

            <div class="number-game-stats">
                <div>Next: <span id="nextNum">1</span></div>
                <div>Time: <span id="timer">0.00</span>s ‚è±Ô∏è</div>
            </div>

            <div class="number-game-grid" id="numberGrid"></div>

            <div class="number-game-footer">
                <div class="number-game-finish" id="finishMsg"></div>
                <button class="save-btn" id="restartNumberGame">Play Again! üîÑ</button>
                <button class="save-btn" style="margin-top: 15px; background: linear-gradient(135deg, var(--lavender-purple), var(--sky-blue));" id="closeNumberFind">
                    Back to MoodSpace! ‚òÄÔ∏è
                </button>
            </div>
        </div>
    </div>
    <button class="close-game" id="closeNumberFindBtn">√ó</button>
</div>

<div class="game-popup" id="colorMatchPopup">
    <div class="game-content">
        <h2 style="margin-bottom: 20px; font-size: 1.8rem;">Rainbow Match Game! üåàüé®</h2>
        <p style="font-size: 1.1rem; margin-bottom: 20px;" id="colorGameInstruction">Match the rainbow colors! You have 60 seconds of colorful fun! ‚è∞‚ú®</p>

        <div id="targetColor">
            <!-- Target color will appear here -->
        </div>

        <div class="color-grid" id="colorGrid">
            <!-- Color buttons will be generated here -->
        </div>

        <div class="game-stats">
            <div class="stat-item">
                <div class="stat-value" id="timeLeft">60</div>
                <div class="stat-label">Seconds ‚è∞</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="matches">0</div>
                <div class="stat-label">Matches üéØ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">Accuracy üèÜ</div>
            </div>
        </div>

        <button class="save-btn" style="margin-top: 25px; background: linear-gradient(135deg, var(--flower-pink), var(--lavender-purple));" id="closeColorGame">
            Back to Rainbow! üåà
        </button>
    </div>
    <button class="close-game" id="closeColorGameBtn">√ó</button>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Prevent default touch behavior
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Initialize main app (your existing app)
        function initMainApp() {
            // Updated emotion data with "I don't know" option
            const emotions = {
                happy: [
                    { name: "Joyful Sunshine! üòÑ", emoji: "üòÑ", specifics: "Lighthearted, Cheerful, Shining!" },
                    { name: "Content & Cozy üåª", emoji: "üòå", specifics: "Satisfied, At Peace, Warm" },
                    { name: "Hopeful Rainbow! üåà", emoji: "üåà", specifics: "Optimistic, Looking Forward" },
                    { name: "Excited Sparkles! ‚ú®", emoji: "ü§©", specifics: "Energetic, Anticipating" },
                    { name: "Grateful Heart! üíñ", emoji: "üôè", specifics: "Thankful, Appreciative" }
                ],
                sad: [
                    { name: "Rainy Day Heart üåßÔ∏è", emoji: "üíî", specifics: "Deeply Hurt, Grieving" },
                    { name: "Lonely Cloud ‚òÅÔ∏è", emoji: "ü•∫", specifics: "Isolated, Longing" },
                    { name: "Disappointed Star üåü", emoji: "üòû", specifics: "Let Down, Unfulfilled" },
                    { name: "Hopeless Fog üå´Ô∏è", emoji: "üòî", specifics: "Despairing, No Energy" },
                    { name: "Numb Space ü™ê", emoji: "üò∂", specifics: "Empty, Detached" }
                ],
                angry: [
                    { name: "Frustrated Volcano üåã", emoji: "üò§", specifics: "Annoyed, Stuck" },
                    { name: "Irritated Storm ‚ö°", emoji: "üò†", specifics: "On Edge, Agitated" },
                    { name: "Resentful Fire üî•", emoji: "ü§¨", specifics: "Bitterness, Hostile" },
                    { name: "Betrayed Thunder ‚õàÔ∏è", emoji: "üò°", specifics: "Let Down, Hurt" },
                    { name: "Outraged Tornado üå™Ô∏è", emoji: "üëø", specifics: "Furious, Enraged" }
                ],
                anxious: [
                    { name: "Worried Butterfly ü¶ã", emoji: "üòü", specifics: "Concerned, Stressed" },
                    { name: "Panicked Rabbit üêá", emoji: "üò®", specifics: "Overwhelmed, Racing" },
                    { name: "Overthinking Hamster üêπ", emoji: "ü§Ø", specifics: "Looping Thoughts" },
                    { name: "Insecure Seed üå±", emoji: "üòï", specifics: "Self-Doubt, Uncertainty" },
                    { name: "Restless Energy ‚ö°", emoji: "üò∞", specifics: "Can't Settle, Tense" }
                ],
                overwhelmed: [
                    { name: "Stressed Mountain üèîÔ∏è", emoji: "üò´", specifics: "Pressure, Too Much" },
                    { name: "Burnt Out Candle üïØÔ∏è", emoji: "üò©", specifics: "Exhausted, Drained" },
                    { name: "Overloaded Basket üß∫", emoji: "üèãÔ∏è", specifics: "Too Many Tasks" },
                    { name: "Confused Maze üåÄ", emoji: "üòµ", specifics: "Can't Think Clearly" },
                    { name: "Stuck Snail üêå", emoji: "ü´†", specifics: "Paralyzed, Frozen" }
                ],
                lonely: [
                    { name: "Isolated Island üèùÔ∏è", emoji: "üë§", specifics: "Alone, No Connection" },
                    { name: "Unseen Ghost üëª", emoji: "üëª", specifics: "Invisible, Ignored" },
                    { name: "Longing Bird üïäÔ∏è", emoji: "üí≠", specifics: "Missing Connection" },
                    { name: "Misunderstood Alien üëΩ", emoji: "ü§∑", specifics: "Not Heard, Alien" },
                    { name: "Homesick Heart üè†", emoji: "üè†", specifics: "Nostalgic, Yearning" }
                ],
                tired: [
                    { name: "Exhausted Sloth ü¶•", emoji: "üò¥", specifics: "Drained, No Energy" },
                    { name: "Burnt Out Phoenix üî•", emoji: "üî•", specifics: "Emotionally Drained" },
                    { name: "Unmotivated Turtle üê¢", emoji: "üõå", specifics: "No Drive, Lethargic" },
                    { name: "Foggy Forest üå≥", emoji: "üå´Ô∏è", specifics: "Can't Focus, Hazy" },
                    { name: "Weary Moon üåô", emoji: "üòÆ‚Äçüí®", specifics: "Tired of Everything" }
                ],
                calm: [
                    { name: "Peaceful Lotus ü™∑", emoji: "‚òÆÔ∏è", specifics: "Serene, Tranquil" },
                    { name: "Content Sunset üåÖ", emoji: "üòä", specifics: "Satisfied, At Ease" },
                    { name: "Grounded Tree üå≥", emoji: "üå≥", specifics: "Centered, Present" },
                    { name: "Relaxed Ocean üåä", emoji: "ü™∑", specifics: "At Rest, Unwound" },
                    { name: "Balanced Scale ‚öñÔ∏è", emoji: "‚öñÔ∏è", specifics: "Harmonious, Steady" }
                ],
                // NEW: "I don't know" emotion options
                unknown: [
                    { name: "Confused Puzzle üß©", emoji: "ü§î", specifics: "Uncertain, Puzzled" },
                    { name: "Blank Canvas üé®", emoji: "üòê", specifics: "Empty, No Clear Feeling" },
                    { name: "Mixed Rainbow üåà", emoji: "üò∂‚Äçüå´Ô∏è", specifics: "Many Feelings at Once" },
                    { name: "Detached Observer üî≠", emoji: "üëÅÔ∏è", specifics: "Observant, Not Feeling" },
                    { name: "Exploring Adventurer üß≠", emoji: "üß≠", specifics: "Curious, Still Discovering" }
                ]
            };

            // Updated coping strategies with "I don't know" options - with sunshine theme
            const copingStrategies = {
                happy: [
                    { title: "üåª Share the Happiness!", description: "Text a friend about something good that happened. Happiness grows when shared like sunshine!" },
                    { title: "üåà Savor the Rainbow!", description: "Take 2 minutes to fully notice and appreciate this good feeling. Where do you feel it in your body?" },
                    { title: "‚ú® Spread Sparkles!", description: "Do one small kind thing for someone else - even just a compliment or a smile!" }
                ],
                sad: [
                    { title: "üåßÔ∏è Rainy Day Self-Care", description: "Put your hand on your heart and say: 'It's okay to have rainy days. The sun will return.'" },
                    { title: "üíå Gentle Release", description: "Write what you're feeling on paper, decorate it with fun drawings, then safely keep it." },
                    { title: "‚òï Cozy Comfort", description: "Make yourself a warm drink, wrap in a soft blanket, watch a favorite happy scene." }
                ],
                angry: [
                    { title: "üî• Energy Release", description: "Do 10 jumping jacks, squeeze a stress ball, or punch a pillow. Release that fire safely!" },
                    { title: "‚ùÑÔ∏è Cool Down", description: "Hold an ice cube in your hand or splash cold water on your face for 30 seconds." },
                    { title: "üé® Anger Art", description: "Draw your anger with bright colors on paper. No one sees it but you!" }
                ],
                anxious: [
                    { title: "üåø Grounding Exercise", description: "Name: 5 yellow things you see, 4 soft things you feel, 3 happy sounds, 2 nice smells, 1 taste you like." },
                    { title: "üõ°Ô∏è Safety Check", description: "Ask: 'Am I actually in danger right now, or just uncomfortable?' Look for evidence of safety." },
                    { title: "üå¨Ô∏è Calm Breathing", description: "Breathe in camly for 4 counts, hold the light for 4, exhale clouds for 6. Repeat 5 times." }
                ],
                overwhelmed: [
                    { title: "üéØ One Sunbeam Only", description: "Close all tabs, put away everything except ONE small task. Focus on just that sunbeam!" },
                    { title: "‚è∏Ô∏è Pause", description: "Set a timer for 5 minutes and do absolutely nothing but breathe. You have permission!" },
                    { title: "üêå Tiny Step", description: "What's the smallest possible next step? Just do that one tiny, manageable thing!" }
                ],
                lonely: [
                    { title: "üì∫ Virtual Mood lifter", description: "Put on a comforting TV show or YouTube video just for background happy human presence." },
                    { title: "üí´ Reach Out with Sparkles", description: "Send a simple text to someone: 'Thinking of you' or a funny happy meme." },
                    { title: "‚òÄÔ∏è Self-Companionship", description: "Talk to yourself kindly, as you would to a friend. Make yourself a special drink." }
                ],
                tired: [
                    { title: "üí¶ Hydration First", description: "Drink a full glass of water right now. Dehydration amplifies exhaustion like clouds block sun!" },
                    { title: "üò¥ Micro-Break", description: "Set a timer for 5 minutes and rest your eyes. No screens, no tasks, just rest." },
                    { title: "üçì Tiny Nourishment", description: "Eat one small, easy thing (fruit, nuts, yogurt). Low blood sugar worsens fatigue." }
                ],
                calm: [
                    { title: "üåÖ Mindful Appreciation", description: "Notice this peaceful feeling. Where do you feel it in your body? Savor it like sunset!" },
                    { title: "üå∏ Gentle Movement", description: "Do some slow stretching or take a gentle walk to maintain this sunny state." },
                    { title: "üìù Happiness Journal", description: "Write a few notes about what helped you reach this calm state for future reference." }
                ],
                // NEW: Coping strategies for "I don't know"
                unknown: [
                    { title: "üîç Gentle Curiosity", description: "Instead of trying to name the feeling, just notice where in your body you feel something. No judgment!" },
                    { title: "üîÑ Permission to Not Know", description: "Say to yourself: 'It's okay that I don't know how I feel right now. I don't need to figure it out.'" },
                    { title: "‚òÅÔ∏è Neutral Grounding", description: "Focus on your breathing for 2 minutes. Just notice the in-breath and out-breath like clouds passing." }
                ]
            };

            // Updated songs with working Spotify track IDs - Happy, uplifting songs!
            // Updated songs with working Spotify track IDs - using specified songs only
            // Final updated songs with working Spotify track IDs
            const songs = {
                happy: [
                    {
                        title: "Can't Stop the Feeling!",
                        artist: "Justin Timberlake",
                        spotifyId: "1WkMMavIMc4JZ8cfMmxHkI",
                        help: "Upbeat, positive energy! Perfect for boosting mood! üíÉ‚ú®"
                    },
                    {
                        title: "Happy",
                        artist: "Pharrell Williams",
                        spotifyId: "60nZcImufyMA1MKQY3dcCH",
                        help: "Bright, upbeat energy that instantly lifts mood and encourages positive emotions ‚òÄÔ∏èüòÑ"
                    },
                    {
                        title: "Best Day of My Life",
                        artist: "American Authors",
                        spotifyId: "5Hroj5K7vLpIG4FNCRIjbP",
                        help: "Celebratory and uplifting! Makes every day brighter! ‚òÄÔ∏èüéâ"
                    }
                ],
                sad: [
                    {
                        title: "Fix You",
                        artist: "Coldplay",
                        spotifyId: "7LVHVU3tWfcxj5aiPFEW4Q",
                        help: "Emotional but safe comfort ü´Ç‚ú®"
                    },
                    {
                        title: "Someone You Loved",
                        artist: "Lewis Capaldi",
                        spotifyId: "7qEHsqek33rTcFNT9PFqLf",
                        help: "Gentle emotional validation - it's okay to feel this üåßÔ∏èüíî"
                    },
                    {
                        title: "Say You Won't Let Go",
                        artist: "James Arthur",
                        spotifyId: "5uCax9HTNlzGybIStD3vDh",
                        help: "Soft, emotional reassurance that feels personal and comforting ü§çüé∂"
                    }
                ],
                angry: [
                    {
                        title: "Believer",
                        artist: "Imagine Dragons",
                        spotifyId: "0pqnGHJpmpxLKifKRmU6WP",
                        help: "Controlled release - turns anger into motivation! üêâüî•"
                    },
                    {
                        title: "Stronger (What Doesn't Kill You)",
                        artist: "Kelly Clarkson",
                        spotifyId: "1nInOsHbtotAmEOQhtvnzP",
                        help: "Motivational power anthem! Transform frustration into strength! üí™üåü"
                    },
                    {
                        title: "Centuries",
                        artist: "Fall Out Boy",
                        spotifyId: "04aAxqtGp5pv12UXAg4pkq",
                        help: "Channel energy into powerful determination! üèÜ‚ú®"
                    }
                ],
                anxious: [
                    {
                        title: "Weightless",
                        artist: "Marconi Union",
                        spotifyId: "6kkwzB6hXLIONkEk9JciA6",
                        help: "Scientifically proven to reduce anxiety by 65%! Calming and slow üß†‚ú®"
                    },
                    {
                        title: "Before You Go",
                        artist: "Lewis Capaldi",
                        spotifyId: "2gMXnyrvIjhVBUZwvLZDMP",
                        help: "Slow, steady emotion that feels grounding rather than overwhelming üå´Ô∏èüíô"
                    },
                    {
                        title: "bad liar",
                        artist: "Imagine Dragons",
                        spotifyId: "2RSHsoi04658QL5xgQVov3",
                        help: "Soft, calming vocals that gently slow racing thoughts üìñ‚ú®"
                    }
                ],
                overwhelmed: [
                    {
                        title: "Let It Be",
                        artist: "The Beatles",
                        spotifyId: "7iN1s7xHE4ifF5povM6A48",
                        help: "Grounding reminder to accept what is üïäÔ∏è‚ú®"
                    },
                    {
                        title: "Experience",
                        artist: "Ludovico Einaudi",
                        spotifyId: "1BncfTJAWxrsxyT9culBrj",
                        help: "Spacious, emotional music that lets thoughts flow without pressure üåä‚ú®"
                    },
                    {
                        title: "Fix You",
                        artist: "Coldplay",
                        spotifyId: "7LVHVU3tWfcxj5aiPFEW4Q",
                        help: "Comforting reminder that things will get better üå™Ô∏èüí´"
                    }
                ],
                lonely: [
                    {
                        title: "Lean On Me",
                        artist: "Bill Withers",
                        spotifyId: "3M8FzayQWtkvOhqMn2V4T2",
                        help: "Warm companionship feeling - you're not alone ü§ùüíñ"
                    },
                    {
                        title: "Fix You",
                        artist: "Coldplay",
                        spotifyId: "7LVHVU3tWfcxj5aiPFEW4Q",
                        help: "Feels like quiet emotional support, reminding you that help exists even when you feel isolated üåôü§ç"
                    }
                    ,
                    {
                        title: "Someone To Stay",
                        artist: "Vancouver Sleep Clinic",
                        spotifyId: "0fYVliAYKHuPmECRs1pbRf",
                        help: "Soft, intimate reassurance that feels like gentle company during lonely moments üïØÔ∏è‚ú®"
                    }
                ],
                tired: [
                    {
                        title: "I Will Follow You Into the Dark",
                        artist: "Death Cab for Cutie",
                        spotifyId: "3kZC0ZmFWrEHdUCmUqlvgZ",
                        help: "Quiet, stripped-down comfort that feels steady and non-demanding üïØÔ∏èüò¥"
                    },
                    {
                        title: "Happier than ever",
                        artist: "Billie Eilish",
                        spotifyId: "4RVwu0g32PAqgUiJoXsdF8",
                        help: "Low-energy, emotionally honest sound that matches exhaustion without pushing you üå´Ô∏èüõå"
                    },
                    {
                        title: "Slow Dancing in a Burning Room",
                        artist: "John Mayer",
                        spotifyId: "2jdAk8ATWIL3dwT47XpRfu",
                        help: "Soft emotional space for burnt-out feelings üî•üíÉ"
                    }
                ],
                calm: [
                    {
                        title: "Come Away With Me",
                        artist: "Norah Jones",
                        spotifyId: "6jG2YzhxptolDzLHTGLt7S",
                        help: "Warm, steady vocals that slow breathing and create a peaceful inner space üåô‚òï"
                    },
                    {
                        title: "All of Me",
                        artist: "John Legend",
                        spotifyId: "3U4isOIWM3VvDubwSI3y7a",
                        help: "Warm, soulful calm that feels steady, grounding, and emotionally safe üåøü§ç"
                    }
                    ,
                    {
                        title: "Pink + White",
                        artist: "Frank Ocean",
                        spotifyId: "3xKsf9qdS1CyvXSMEid6g8",
                        help: "Smooth, flowing sound that feels emotionally calm and reassuring without heaviness üå∏‚òÅÔ∏è"
                    }
                ],
                unknown: [
                    {
                        title: "Experience",
                        artist: "Ludovico Einaudi",
                        spotifyId: "1BncfTJAWxrsxyT9culBrj",
                        help: "Neutral space with no emotional pressure üéπüí≠"
                    },
                    {
                        title: "Startgrazing",
                        artist: "Kygo, Justin Jesso",
                        spotifyId: "0Zbbxnx4SGGHoIow4PpISP",
                        help: "Soft, flowing piano that creates mental space without pushing any emotion üåäüéπ"
                    },
                    {
                        title: "Sunset Lover",
                        artist: "Petit Biscuit",
                        spotifyId: "0hNduWmlWmEmuwEFcYvRu1",
                        help: "No pressure - just peaceful background ü§îüåÖ"
                    }
                ]
            }

            // App state
            let selectedCoreEmotion = null;
            let selectedSpecificEmotion = null;
            let currentlyActiveSong = null;

            // Game state variables for number game
            let numberGame = {
                current: 1,
                startTime: null,
                timerInterval: null
            };

            let colorGame = {
                timeLeft: 60,
                matches: 0,
                totalClicks: 0,
                gameInterval: null,
                targetColor: null
            };

            // DOM Elements
            const page1 = document.getElementById('page1');
            const page2 = document.getElementById('page2');
            const emotionGridContainer = document.getElementById('emotionGridContainer');
            const copingSection = document.getElementById('copingSection');
            const selectedEmotionText = document.getElementById('selectedEmotionText');
            const selectedEmotionTag = document.getElementById('selectedEmotionTag');
            const backToPage1Btn = document.getElementById('backToPage1');
            const saveEntryBtn = document.getElementById('saveEntryBtn');
            const moodButtons = document.querySelectorAll('.big-mood-btn');

            // Initialize
            function initApp() {
                // Set up mood buttons - auto-navigate to page 2 when clicked
                moodButtons.forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        // Prevent multiple rapid clicks on mobile
                        if (e.type === 'touchstart') {
                            e.preventDefault();
                        }

                        // Remove selection from all buttons
                        moodButtons.forEach(b => {
                            b.style.opacity = '0.7';
                            b.style.transform = 'none';
                        });

                        // Select this button
                        this.style.opacity = '1';
                        this.style.transform = 'scale(1.05)';

                        selectedCoreEmotion = this.dataset.emotion;
                        selectedEmotionText.textContent = this.querySelector('span').textContent;

                        // Auto-navigate to page 2
                        setTimeout(() => {
                            loadPage2();
                            page1.classList.remove('active');
                            page2.classList.add('active');
                            // Scroll to top on page change
                            window.scrollTo(0, 0);
                        }, 300);
                    });

                    // Add touch events for mobile
                    btn.addEventListener('touchstart', function(e) {
                        this.style.transform = 'scale(0.98)';
                    });

                    btn.addEventListener('touchend', function(e) {
                        this.style.transform = 'scale(1.05)';
                    });
                });

                // Back button at top - FIXED
                backToPage1Btn.addEventListener('click', function(e) {
                    if (e.type === 'touchstart') {
                        e.preventDefault();
                    }
                    page2.classList.remove('active');
                    page1.classList.add('active');
                    resetPage2();
                    // Scroll to top on page change
                    window.scrollTo(0, 0);
                });

                saveEntryBtn.addEventListener('click', saveEntry);

                // Game setup
                setupGames();
            }

            function loadPage2() {
                // Load specific emotions for selected core emotion
                const specificEmotions = emotions[selectedCoreEmotion];

                // Update header
                selectedEmotionText.textContent = getEmotionDisplayName(selectedCoreEmotion);
                const emotionColorElement = document.querySelector(`.${selectedCoreEmotion}-color`);
                if (emotionColorElement) {
                    selectedEmotionTag.style.borderBottomColor = getComputedStyle(emotionColorElement).borderBottomColor;
                }

                // Clear previous emotions
                emotionGridContainer.innerHTML = '';

                // Create emotion grid
                const grid = document.createElement('div');
                grid.className = 'emotion-grid';

                specificEmotions.forEach(emotion => {
                    const emotionBtn = document.createElement('button');
                    emotionBtn.className = 'emotion-option';
                    emotionBtn.innerHTML = `
                        <div class="emotion-emoji">${emotion.emoji}</div>
                        <div class="emotion-name">${emotion.name}</div>
                        <div class="emotion-subtitle">${emotion.specifics}</div>
                    `;

                    emotionBtn.addEventListener('click', function(e) {
                        if (e.type === 'touchstart') {
                            e.preventDefault();
                        }

                        // Remove selection from all
                        document.querySelectorAll('.emotion-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });

                        // Select this one
                        this.classList.add('selected');
                        selectedSpecificEmotion = emotion.name;

                        // Show coping strategies after a short delay
                        setTimeout(() => {
                            showCopingStrategies();
                        }, 300);
                    });

                    // Add touch events for mobile
                    emotionBtn.addEventListener('touchstart', function(e) {
                        this.style.transform = 'translateY(-2px) scale(0.98)';
                    });

                    emotionBtn.addEventListener('touchend', function(e) {
                        this.style.transform = 'translateY(-5px) scale(1.03)';
                    });

                    grid.appendChild(emotionBtn);
                });

                emotionGridContainer.appendChild(grid);

                // Hide coping section initially
                copingSection.style.display = 'none';
            }

            function showCopingStrategies() {
                // Show coping section
                copingSection.style.display = 'block';

                // Load coping strategies
                const strategies = copingStrategies[selectedCoreEmotion];
                const copingGrid = document.getElementById('copingGrid');
                copingGrid.innerHTML = '';

                strategies.forEach(strategy => {
                    const card = document.createElement('div');
                    card.className = 'coping-card';
                    card.innerHTML = `
                        <h3><i class="fas fa-lightbulb"></i> ${strategy.title}</h3>
                        <p>${strategy.description}</p>
                    `;
                    copingGrid.appendChild(card);
                });

                // Load songs with Spotify embeds
                const songList = document.getElementById('songList');
                songList.innerHTML = '';

                const emotionSongs = songs[selectedCoreEmotion];
                emotionSongs.forEach((song, index) => {
                    const songItem = document.createElement('div');
                    songItem.className = 'song-item';
                    if (index === 0) {
                        songItem.classList.add('active');
                        currentlyActiveSong = songItem;
                    }

                    // Create Spotify embed URL
                    const spotifyEmbedUrl = `https://open.spotify.com/embed/track/${song.spotifyId}`;

                    songItem.innerHTML = `
                        <div class="song-info">
                            <div class="song-title">${song.title}</div>
                            <div class="song-artist">${song.artist}</div>
                            <div class="song-help">${song.help}</div>
                            <div style="margin-top: 10px; font-size: 0.9rem; color: var(--sunshine-orange); font-weight: 600;">
                                <i class="fab fa-spotify"></i> Click to play any music! üé∂
                            </div>
                        </div>
                        <iframe
                            class="spotify-player"
                            src="${spotifyEmbedUrl}"
                            width="100%"
                            height="152"
                            frameBorder="0"
                            allowfullscreen=""
                            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                            loading="lazy">
                        </iframe>
                    `;

                    // Add click event to toggle the Spotify player
                    const songInfo = songItem.querySelector('.song-info');
                    songInfo.addEventListener('click', function(e) {
                        if (e.type === 'touchstart') {
                            e.preventDefault();
                        }

                        // Close any currently active song
                        if (currentlyActiveSong && currentlyActiveSong !== songItem) {
                            currentlyActiveSong.classList.remove('active');
                            const activeIframe = currentlyActiveSong.querySelector('.spotify-player');
                            if (activeIframe) {
                                // Reset the iframe to stop playback
                                const src = activeIframe.src;
                                activeIframe.src = '';
                                setTimeout(() => {
                                    activeIframe.src = src;
                                }, 100);
                            }
                        }

                        // Toggle this song
                        songItem.classList.toggle('active');

                        if (songItem.classList.contains('active')) {
                            currentlyActiveSong = songItem;

                            // Auto-play when clicked
                            const iframe = songItem.querySelector('.spotify-player');
                            if (iframe) {
                                const src = iframe.src;
                                iframe.src = '';
                                setTimeout(() => {
                                    iframe.src = src;
                                }, 100);
                            }
                        } else {
                            currentlyActiveSong = null;
                        }
                    });

                    songList.appendChild(songItem);
                });

                // Auto-scroll to coping strategies
                setTimeout(() => {
                    copingSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 500);
            }

            function setupGames() {
                // Number Find game
                document.getElementById('numberFindGame').addEventListener('click', function(e) {
                    if (e.type === 'touchstart') {
                        e.preventDefault();
                    }
                    document.getElementById('numberFindPopup').classList.add('active');
                    startNumberGame();
                });

                // Color Match game
                document.getElementById('colorMatchGame').addEventListener('click', function(e) {
                    if (e.type === 'touchstart') {
                        e.preventDefault();
                    }
                    document.getElementById('colorMatchPopup').classList.add('active');
                    startColorMatchGame();
                });

                // Game close buttons
                document.getElementById('closeNumberFind').addEventListener('click', closeNumberGame);
                document.getElementById('closeNumberFindBtn').addEventListener('click', closeNumberGame);
                document.getElementById('closeColorGame').addEventListener('click', closeColorGame);
                document.getElementById('closeColorGameBtn').addEventListener('click', closeColorGame);
                document.getElementById('restartNumberGame').addEventListener('click', startNumberGame);
            }

            // NUMBER GAME FUNCTIONS
            function startNumberGame() {
                const grid = document.getElementById("numberGrid");
                const timerEl = document.getElementById("timer");
                const nextNumEl = document.getElementById("nextNum");
                const finishMsg = document.getElementById("finishMsg");

                grid.innerHTML = "";
                finishMsg.textContent = "";
                numberGame.current = 1;
                nextNumEl.textContent = numberGame.current;
                timerEl.textContent = "0.00";
                clearInterval(numberGame.timerInterval);
                numberGame.startTime = null;

                const numbers = shuffle([...Array(25).keys()].map(n => n + 1));

                numbers.forEach(num => {
                    const tile = document.createElement("div");
                    tile.className = "number-game-tile";
                    tile.textContent = num;
                    tile.onclick = () => handleNumberClick(tile, num);
                    // Add touch events for mobile
                    tile.addEventListener('touchstart', function(e) {
                        this.style.transform = 'translateY(-1px) scale(0.98)';
                    });
                    tile.addEventListener('touchend', function(e) {
                        this.style.transform = 'translateY(-3px) scale(1.05)';
                    });
                    grid.appendChild(tile);
                });
            }

            function handleNumberClick(tile, num) {
                if (num !== numberGame.current) return;

                if (numberGame.current === 1) startNumberTimer();

                tile.classList.add("correct", "disabled");
                numberGame.current++;
                document.getElementById("nextNum").textContent = numberGame.current;

                if (numberGame.current > 25) endNumberGame();
            }

            function startNumberTimer() {
                numberGame.startTime = Date.now();
                numberGame.timerInterval = setInterval(() => {
                    document.getElementById("timer").textContent = ((Date.now() - numberGame.startTime) / 1000).toFixed(2);
                }, 10);
            }

            function endNumberGame() {
                clearInterval(numberGame.timerInterval);
                const timerEl = document.getElementById("timer").textContent;
                document.getElementById("finishMsg").textContent = `üéâ Amazing! Completed in ${timerEl} seconds! üéâ`;
                document.getElementById("finishMsg").style.animation = "celebrateText 1s infinite";
            }

            function shuffle(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            function closeNumberGame() {
                document.getElementById('numberFindPopup').classList.remove('active');
                if (numberGame.timerInterval) {
                    clearInterval(numberGame.timerInterval);
                }
            }

            // COLOR GAME FUNCTIONS
            function startColorMatchGame() {
                // Reset game state
                colorGame = {
                    timeLeft: 60,
                    matches: 0,
                    totalClicks: 0,
                    gameInterval: null,
                    targetColor: null
                };

                // Update display
                updateColorGameDisplay();

                // Create color grid
                createColorGrid();

                // Set target color
                setNewTargetColor();

                // Start timer
                colorGame.gameInterval = setInterval(() => {
                    colorGame.timeLeft--;
                    updateColorGameDisplay();

                    if (colorGame.timeLeft <= 0) {
                        endColorGame();
                    }
                }, 1000);
            }

            function createColorGrid() {
                const gridEl = document.getElementById('colorGrid');
                gridEl.innerHTML = '';

                const colors = [
                    '#FFD700', '#FF69B4', '#40E0D0', '#7CFC00',
                    '#9370DB', '#87CEEB', '#FF7F50', '#FF8C00'
                ];

                // Shuffle colors
                const shuffledColors = [...colors].sort(() => Math.random() - 0.5);

                shuffledColors.forEach((color, index) => {
                    const btn = document.createElement('div');
                    btn.className = 'color-btn';
                    btn.style.backgroundColor = color;
                    btn.dataset.color = color;
                    btn.dataset.index = index;

                    btn.addEventListener('click', function(e) {
                        if (e.type === 'touchstart') {
                            e.preventDefault();
                        }

                        if (colorGame.timeLeft <= 0) return;

                        colorGame.totalClicks++;
                        const clickedColor = this.dataset.color;

                        if (clickedColor === colorGame.targetColor) {
                            // Correct match
                            colorGame.matches++;
                            this.classList.add('correct');

                            // Visual feedback
                            this.style.transform = 'scale(1.1) rotate(5deg)';
                            setTimeout(() => {
                                this.style.transform = 'scale(1) rotate(0)';
                                this.classList.remove('correct');
                            }, 300);

                            // Set new target color
                            setNewTargetColor();
                        } else {
                            // Incorrect
                            this.classList.add('incorrect');
                            setTimeout(() => {
                                this.classList.remove('incorrect');
                            }, 300);
                        }

                        updateColorGameDisplay();
                    });

                    // Add touch events for mobile
                    btn.addEventListener('touchstart', function(e) {
                        this.style.transform = 'scale(1.05) rotate(2deg)';
                    });

                    btn.addEventListener('touchend', function(e) {
                        this.style.transform = 'scale(1.1) rotate(5deg)';
                    });

                    gridEl.appendChild(btn);
                });
            }

            function setNewTargetColor() {
                const colors = [
                    '#FFD700', '#FF69B4', '#40E0D0', '#7CFC00',
                    '#9370DB', '#87CEEB', '#FF7F50', '#FF8C00'
                ];

                // Pick a random color from the grid
                const colorButtons = document.querySelectorAll('.color-btn');
                if (colorButtons.length > 0) {
                    const randomIndex = Math.floor(Math.random() * colorButtons.length);
                    colorGame.targetColor = colorButtons[randomIndex].dataset.color;

                    // Update target color display
                    const targetColorEl = document.getElementById('targetColor');
                    targetColorEl.style.backgroundColor = colorGame.targetColor;
                }
            }

            function updateColorGameDisplay() {
                document.getElementById('timeLeft').textContent = colorGame.timeLeft;
                document.getElementById('matches').textContent = colorGame.matches;

                const accuracy = colorGame.totalClicks > 0 ?
                    Math.round((colorGame.matches / colorGame.totalClicks) * 100) : 0;
                document.getElementById('accuracy').textContent = `${accuracy}%`;
            }

            function endColorGame() {
                clearInterval(colorGame.gameInterval);

                const instructionEl = document.getElementById('colorGameInstruction');
                const accuracy = colorGame.totalClicks > 0 ?
                    Math.round((colorGame.matches / colorGame.totalClicks) * 100) : 0;

                instructionEl.textContent = `üåà Time's up! You made ${colorGame.matches} rainbow matches with ${accuracy}% accuracy! üåà`;

                // Disable buttons
                const buttons = document.querySelectorAll('.color-btn');
                buttons.forEach(btn => {
                    btn.style.pointerEvents = 'none';
                    btn.style.opacity = '0.7';
                });
            }

            function closeColorGame() {
                document.getElementById('colorMatchPopup').classList.remove('active');
                if (colorGame.gameInterval) {
                    clearInterval(colorGame.gameInterval);
                }
            }

            function saveEntry() {
                if (!selectedSpecificEmotion) {
                    alert("üåà Please select a specific feeling first! üåà");
                    return;
                }

                // Save to localStorage with user association
                const currentUser = "anonymous";
                const entry = {
                    date: new Date().toISOString(),
                    coreEmotion: selectedCoreEmotion,
                    specificEmotion: selectedSpecificEmotion,
                    timestamp: Date.now(),
                    user: currentUser
                };

                // Get existing entries
                let entries = JSON.parse(localStorage.getItem('moodEntries') || '[]');
                entries.unshift(entry); // Add to beginning

                // Keep only last 50 entries
                if (entries.length > 50) {
                    entries = entries.slice(0, 50);
                }

                localStorage.setItem('moodEntries', JSON.stringify(entries));

                // Show confirmation
                alert("üéâ Check-in saved! Remember to shine bright today! ‚ú®");

                // Reset and go back to page 1
                resetPage2();
                page2.classList.remove('active');
                page1.classList.add('active');

                // Reset page 1 selections
                moodButtons.forEach(btn => {
                    btn.style.opacity = '1';
                    btn.style.transform = 'none';
                });
                selectedCoreEmotion = null;

                // Scroll to top on page change
                window.scrollTo(0, 0);
            }

            function resetPage2() {
                selectedSpecificEmotion = null;
                copingSection.style.display = 'none';

                // Close any active song players
                if (currentlyActiveSong) {
                    currentlyActiveSong.classList.remove('active');
                    currentlyActiveSong = null;
                }
            }

            function getEmotionDisplayName(emotion) {
                const displayNames = {
                    happy: "Happy üòä",
                    sad: "Sad üåßÔ∏è",
                    angry: "Angry/Irritated üî•",
                    anxious: "Fearful/Anxious ü¶ã",
                    overwhelmed: "Overwhelmed üå™Ô∏è",
                    lonely: "Lonely üåô",
                    tired: "Tired/Burnt Out üí§",
                    calm: "Calm/Peaceful üåø",
                    unknown: "I DON'T KNOW ü§î"
                };
                return displayNames[emotion] || capitalizeFirstLetter(emotion);
            }

            function capitalizeFirstLetter(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }

            // Initialize the app
            initApp();
        }

        // Start everything when page loads
        initMainApp();
    });
</script>
</body>
</html>
