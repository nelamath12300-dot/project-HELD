<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Box Breathing</title>

<style>
:root{
  /* üåà NEW COLOR PALETTE: Blue, Beige, Green */
  --inhale:#4a90e2;     /* Soft Blue */
  --hold:#f5f1e6;       /* Warm Beige */
  --exhale:#50c878;     /* Fresh Green */
  --muted:#a0aec0;      /* Muted Blue-Gray */
  --bg-start:#2c5282;   /* Dark Blue */
  --bg-end:#48bb78;     /* Teal Green */
  --card-bg:#ffffff;    /* White/Beige */
  --text-dark:#2d3748;  /* Dark Gray */
  --text-light:#f7fafc; /* Light Gray */
}

*{box-sizing:border-box}

body{
  margin:0;
  height:100vh;
  background:linear-gradient(135deg, var(--bg-start), var(--bg-end));
  font-family:"Playfair Display", serif;
  color:var(--text-light);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

/* back */
.back-btn{
  position:absolute;
  top:20px;
  left:20px;
  padding:10px 18px;
  border-radius:999px;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(10px);
  cursor:pointer;
  color:var(--text-light);
  font-weight:600;
  border:1px solid rgba(255,255,255,0.2);
  transition:all 0.3s ease;
}

.back-btn:hover{
  background:rgba(255,255,255,0.25);
  transform:translateY(-2px);
}

/* card */
.container{
  width:380px;
  background:var(--card-bg);
  border-radius:28px;
  padding:32px 28px 34px;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,0.25);
  color:var(--text-dark);
}

.container h1{
  font-size:36px;
  margin:0 0 8px 0;
  background:linear-gradient(90deg, var(--bg-start), var(--bg-end));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

/* grid */
.grid-wrap{
  margin:32px auto 20px;
  width:240px;
  height:240px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.grid{
  position:relative;
  display:grid;
  grid-template-columns:repeat(11,1fr);
  gap:12px;
  width:220px;
  height:220px;
}

.grid span{
  width:10px;
  height:10px;
  background:rgba(74, 144, 226, 0.15); /* Blue tint */
  border-radius:50%;
  opacity:0;
  animation:fadeIn .8s forwards;
}

@keyframes fadeIn{
  to{opacity:1}
}

/* moving ball */
.mover{
  width:20px;
  height:20px;
  border-radius:50%;
  position:absolute;
  top:0;
  left:0;
  background:var(--inhale);
  box-shadow:0 0 20px rgba(74, 144, 226, 0.5);
  transition:transform 4s linear, background 1s ease, box-shadow 1s ease;
}

/* text */
.phase{
  font-size:28px;
  margin-top:16px;
  font-weight:700;
  color:var(--text-dark);
}

.subtext{
  font-family:Inter,sans-serif;
  font-size:15px;
  color:var(--muted);
  margin-top:8px;
  line-height:1.5;
}

/* buttons */
button{
  margin-top:24px;
  padding:14px 32px;
  border-radius:999px;
  border:none;
  cursor:pointer;
  background:linear-gradient(90deg, var(--inhale), var(--exhale));
  color:white;
  font-weight:600;
  font-size:16px;
  transition:all 0.3s ease;
  box-shadow:0 4px 20px rgba(74, 144, 226, 0.3);
}

button:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 25px rgba(74, 144, 226, 0.4);
}

/* feedback */
.feedback{
  display:none;
  margin-top:28px;
  padding-top:24px;
  border-top:2px solid rgba(245, 241, 230, 0.5);
}

.feedback h3{
  font-size:22px;
  margin-bottom:18px;
  color:var(--text-dark);
}

.choices{
  display:flex;
  gap:12px;
  justify-content:center;
  margin-bottom:20px;
}

.choice{
  border:2px solid var(--hold);
  border-radius:999px;
  padding:10px 18px;
  font-size:14px;
  cursor:pointer;
  color:var(--text-dark);
  background:var(--hold);
  transition:all 0.3s ease;
}

.choice:hover{
  border-color:var(--inhale);
  transform:translateY(-2px);
}

.choice.active{
  background:linear-gradient(90deg, var(--inhale), var(--exhale));
  border-color:transparent;
  color:white;
  box-shadow:0 4px 15px rgba(74, 144, 226, 0.3);
}
</style>
</head>

<body>

<div class="back-btn" onclick="location.href='breathing.html'">‚Üê Back</div>

<div class="container">
  <h1>Box Breathing</h1>
  <p class="subtext">Breathe in four calm steps</p>

  <div class="grid-wrap">
    <div class="grid" id="grid">
      <div class="mover" id="mover"></div>
    </div>
  </div>

  <div class="phase" id="phase">Ready</div>
  <div class="subtext" id="helperText"></div>

  <button id="startBtn">Start</button>

  <!-- FEEDBACK -->
  <div class="feedback" id="feedback">
    <h3>How helpful was this exercise?</h3>
    <div class="choices">
      <div class="choice">Not helpful</div>
      <div class="choice">A little helpful</div>
      <div class="choice">Very helpful</div>
    </div>
    <button onclick="location.href='breathing.html'">Done</button>
  </div>
</div>

<script>
const grid = document.getElementById("grid");
const mover = document.getElementById("mover");
const phase = document.getElementById("phase");
const helperText = document.getElementById("helperText");
const startBtn = document.getElementById("startBtn");
const feedback = document.getElementById("feedback");

/* build dots */
for(let i=0;i<121;i++){
  const d=document.createElement("span");
  grid.appendChild(d);
}

// FIXED: Calculate the distance to reach the last dot
// Grid has 11 columns with 10 gaps between them
// Each gap is 12px (from CSS: gap:12px)
// Each dot is 10px wide
// The total distance from first dot center to last dot center is:
// (10 gaps * 12px) + (10 dots * 10px) - 10px (adjustment for dot size)
const STEP = 20; // Distance per step
const EDGE = 220; // Total width/height of the grid (220px)

const steps = [
  { name:"Inhale", color:"var(--inhale)", x:EDGE, y:0 },
  { name:"Hold",   color:"var(--hold)",   x:EDGE, y:EDGE },
  { name:"Exhale", color:"var(--exhale)", x:0,    y:EDGE },
  { name:"Hold",   color:"var(--hold)",   x:0,    y:0 }
];

let index=0;
let cycles=0;
const MAX=4;

function getSettled(){
  phase.textContent="Get settled";
  helperText.textContent="Allow your shoulders to relax and gently focus on your breath.";
  mover.style.transform="translate(0,0)";
  mover.style.background="var(--hold)";
  mover.style.boxShadow="0 0 20px rgba(245, 241, 230, 0.5)";

  setTimeout(()=>{
    helperText.textContent="";
    runStep();
  },6000);
}

function runStep(){
  const s=steps[index];
  phase.textContent=s.name;
  mover.style.background=s.color;
  mover.style.boxShadow=`0 0 20px ${s.color}80`;
  mover.style.transform=`translate(${s.x}px,${s.y}px)`;

  index=(index+1)%steps.length;
  if(index===0) cycles++;

  if(cycles<MAX){
    setTimeout(runStep,4000);
  }else{
    endSession();
  }
}

function endSession(){
  phase.textContent="Well done";
  helperText.textContent="Take a moment to notice how your body feels.";
  feedback.style.display="block";
}

startBtn.onclick=()=>{
  startBtn.remove();
  getSettled();
};

/* feedback UI */
document.querySelectorAll(".choice").forEach(c=>{
  c.onclick=()=>{
    document.querySelectorAll(".choice").forEach(x=>x.classList.remove("active"));
    c.classList.add("active");
  };
});
</script>

</body>
</html>
