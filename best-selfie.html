<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Best Selfie</title>

<style>
body{
  margin:0;
  background:#ffffff2a;
  font-family: Inter, system-ui, -apple-system;
}
#bestSelfApp{
  max-width:1100px;
  margin:0 auto;
  padding:32px;
  color:#1f2937;
}

/* BACK BUTTON */
.back-btn{
  display:inline-block;
  margin:14px 0 4px 28px;
  padding:8px 10px;
  border-radius:8px;
  background:#0001;
  cursor:pointer;
  font-weight:700;
}
.back-btn:hover{background:#0002}

/* PANEL */
.panel-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:20px;
  background:#fff;
  padding:24px;
  border-radius:20px;
}
.card{
  background:#bd86cabb;
  border-radius:22px;
  padding:32px;
  box-shadow:0 18px 50px #0002;
}
.card h3{font-size:26px;margin-bottom:4px}
.card p{color:#333;margin-bottom:12px}

/* ROLES */
.roles{display:flex;gap:12px;flex-wrap:wrap}
.role{
  padding:12px 18px;
  border-radius:999px;
  background:#f3ecff;
  cursor:pointer;
}
.role.selected{
  background:#7f4bc2;
  color:#fff;
}

/* STRENGTHS */
.strengths{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
}
.strength{
  padding:14px;
  border-radius:14px;
  background:#f7f4ff;
  text-align:center;
  cursor:pointer;
}
.strength.chosen{
  background:#d8b4fe;
  color:#4c1d95;
  font-weight:700;
}

/* BUTTONS */
.btn{
  padding:12px 20px;
  border-radius:999px;
  border:none;
  font-weight:600;
  cursor:pointer;
}
.btn.primary{background:#6d3eb8;color:#fff}
.btn.secondary{background:#e5e7eb}
.btn:disabled{opacity:.45}

/* PHOTO AREA */
.photo-section{
  margin-top:24px;
  padding:22px;
  border-radius:18px;
  background:#fff;
}
.photo-actions{display:flex;gap:12px;flex-wrap:wrap}
.photo-btn{
  padding:10px 16px;
  border-radius:999px;
  border:1px solid #aaa;
  background:#fff;
  cursor:pointer;
  font-weight:600;
}

/* PREVIEW CARD */
.preview-wrap{
  width:300px;
  height:380px;
  margin-top:14px;
  border-radius:26px;
  overflow:hidden;
  position:relative;
  background:#111;
}
.preview-wrap img{
  width:100%;
  height:100%;
  object-fit:cover;
}
.overlay{
  position:absolute;
  inset:0;
  padding:18px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  color:#fff;
  font-family:"Playfair Display",serif;
}
.overlay-top{font-size:13px;opacity:.85}
.overlay-role{font-size:26px;margin-top:2px}
.overlay-bottom{font-size:15px}
.str-line{line-height:1.4}

/* CAMERA MODAL */
.camera-modal{
  position:fixed;
  inset:0;
  background:#000c;
  display:none;
  justify-content:center;
  align-items:center;
}
.camera-box{
  background:#111;
  padding:18px;
  border-radius:14px;
}
video{width:360px;border-radius:10px}

/* REVIEW (Retake / Use Photo) */
.review-modal{
  position:fixed;
  inset:0;
  background:#000c;
  display:none;
  justify-content:center;
  align-items:center;
}
.review-box{text-align:center}
.review-img{
  width:360px;
  border-radius:18px;
}
.review-actions{
  margin-top:14px;
  display:flex;
  gap:14px;
  justify-content:center;
}
.review-btn{
  padding:12px 18px;
  border-radius:999px;
  border:none;
  font-weight:700;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="back-btn" onclick="location.href='best-self.html'">← Back</div>

<div id="bestSelfApp">

<h1 style="font-family:'Playfair Display',serif;margin:4px 0 4px">
  Best Selfie
</h1>

<p style="font-size:15px;color:#4b475c">
  “You already carry these strengths within you — this card is your reminder.”
</p>

<div id="detail"></div>
</div>

<!-- CAMERA POPUP -->
<div class="camera-modal" id="cameraModal">
  <div class="camera-box">
    <video id="cameraFeed" autoplay></video><br>
    <button class="btn primary" onclick="capturePhoto()">Capture</button>
    <button class="btn secondary" onclick="closeCamera()">Cancel</button>
  </div>
</div>

<!-- REVIEW CAPTURED PHOTO -->
<div class="review-modal" id="reviewModal">
  <div class="review-box">
    <img id="reviewImg" class="review-img">
    <div class="review-actions">
      <button class="review-btn" onclick="retakePhoto()">Retake</button>
      <button class="review-btn" onclick="usePhoto()">Use Photo</button>
    </div>
  </div>
</div>

<script>
const detail=document.getElementById("detail");
let chosenRole=null;
let chosenStrengths=[];
let stream=null;
let capturedData=null;

/* STEP 1 — ROLE */
renderRole();
function renderRole(){
detail.innerHTML=`
<div class="panel-grid">
<div class="card">

<h3>Select your role</h3>
<p>(Choose the role that reflects how you want to show up)</p>

<div class="roles">
${["Self","Student","Professional","Friend","Partner","Parent","Sibling","Mentor"]
.map(r=>`<div class="role" data-role="${r}">${r}</div>`).join("")}
</div>

<div style="margin-top:18px">
  <button class="btn primary" id="nextRole" disabled>Next</button>
</div>

</div></div>
`;

document.querySelectorAll(".role").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".role").forEach(r=>r.classList.remove("selected"));
    btn.classList.add("selected");
    chosenRole=btn.dataset.role;
    nextRole.disabled=false;
  };
});

document.getElementById("nextRole").onclick=renderStrengths;
}

/* STEP 2 — STRENGTHS */
function renderStrengths(){

const list=[
 "Compassionate","Patient","Curious","Creative","Confident","Calm",
 "Resilient","Empathetic","Honest","Supportive","Loyal","Mindful",
 "Focused","Determined","Respectful","Adaptable","Brave","Kind","Generous","Driven"
];

detail.innerHTML=`
<div class="panel-grid">
<div class="card">

<h3>Channel your strengths</h3>
<p>Select exactly three.</p>

<div class="strengths">
${list.map(s=>`<div class="strength" data-s="${s}">${s}</div>`).join("")}
</div>

<div style="margin-top:18px">
  <button class="btn secondary" onclick="renderRole()">Back</button>
  <button class="btn primary" id="toPhoto" disabled>Next</button>
</div>

</div></div>
`;

chosenStrengths=[];

document.querySelectorAll(".strength").forEach(el=>{
 el.onclick=()=>{
  const s=el.dataset.s;

  if(el.classList.contains("chosen")){
    el.classList.remove("chosen");
    chosenStrengths=chosenStrengths.filter(x=>x!==s);
  }
  else if(chosenStrengths.length<3){
    el.classList.add("chosen");
    chosenStrengths.push(s);
  }

  document.getElementById("toPhoto").disabled =
    chosenStrengths.length!==3;
 };
});

document.getElementById("toPhoto").onclick=renderPhotoStep;
}

/* STEP 3 — PHOTO CARD */
function renderPhotoStep(){

detail.innerHTML=`
<div class="panel-grid">
<div class="card">

<h3>Your Best Self</h3>
<p>(Now create your reminder card)</p>

<div class="photo-section">

  <div class="photo-actions">

    <button class="photo-btn" onclick="openCamera()">Take photo</button>

    <label class="photo-btn">
      Upload photo
      <input type="file" accept="image/*" hidden onchange="previewFromUpload(event)">
    </label>

  </div>

  <div id="previewArea" style="display:none">
    <div class="preview-wrap">
      <img id="previewImg">

      <div class="overlay">
        <div>
          <div class="overlay-top">As a…</div>
          <div class="overlay-role">${chosenRole}</div>
        </div>

        <div class="overlay-bottom">
          I am…
          <div class="str-line">${chosenStrengths.join("<br>")}</div>
        </div>
      </div>
    </div>

    <div style="margin-top:14px">
      <button class="btn primary" onclick="location.href='best-self.html'">
        Done
      </button>
    </div>
  </div>

</div>
</div>
</div>
`;
}

/* ===== CAMERA ===== */
async function openCamera(){
 try{
  stream=await navigator.mediaDevices.getUserMedia({video:true});
  cameraFeed.srcObject=stream;
  cameraModal.style.display="flex";
 }catch(e){
  alert("Camera permission blocked or unavailable");
 }
}

function closeCamera(){
 if(stream) stream.getTracks().forEach(t=>t.stop());
 cameraModal.style.display="none";
}

/* ===== CAPTURE — SHOW REVIEW SCREEN ===== */
function capturePhoto(){
 const canvas=document.createElement("canvas");
 canvas.width=cameraFeed.videoWidth;
 canvas.height=cameraFeed.videoHeight;
 canvas.getContext("2d").drawImage(cameraFeed,0,0);

 capturedData = canvas.toDataURL("image/png");

 reviewImg.src = capturedData;
 reviewModal.style.display="flex";

 closeCamera();
}

/* RETAKE — open camera again */
function retakePhoto(){
 reviewModal.style.display="none";
 openCamera();
}

/* USE PHOTO — apply to card */
function usePhoto(){
 previewImg.src = capturedData;
 previewArea.style.display="block";
 reviewModal.style.display="none";
}

/* UPLOAD PREVIEW */
function previewFromUpload(e){
 const file=e.target.files[0];
 if(!file) return;
 previewImg.src=URL.createObjectURL(file);
 previewArea.style.display="block";
}
</script>

</body>
</html>
